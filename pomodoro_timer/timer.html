<header>    
    <style>
    </style>
</header>

<body>
    <h1 style = "text-align: center; position:relative; top:30px">Pomodoro Timer Plus+</h1>
    <div style = "display:flex; flex-direction: column; align-items: center;">
        <p id="timer">A</p>
        <div style = "display:flex; justify-content: center;">
            <button class = "button" onClick = "countDown()"> Start </button>
            <button class = "button" onClick = "reset()"> Reset </button>
        </div>
    </div>

    <script>
        //console.log(document.getElementById("timer"))
        const MINIUTE = 60;

        // FOR TESTING
        // let init_time = Math.floor(0.1*MINIUTE) - 4;
        ///
        
        let init_time = Math.floor(60*MINIUTE) // in seconds

        let update_time = (time)=>{
            var min = Math.floor(time/MINIUTE); min = min.toString();
            var sec = time%MINIUTE; sec = sec.toString();
            document.getElementById("timer").innerHTML = min.padStart(2, '0') + ":" + sec.padStart(2, '0');
        }        
        update_time(init_time); // init

        let started = false; // only respond to 'start' when started == false
        let refreshIntervalId = null; // setInterval ID for clearing
        function countDown(){
            if (started) return;
            else started = true;

            let time = init_time;
            refreshIntervalId = setInterval(() => {
                if(time == 0) {
                    beep();
                    reset();
                    return;
                }
                time--;
                update_time(time);        
            }, 1000);
            
            //alert("End!");
        } 

        function reset(){
            clearInterval(refreshIntervalId);
            started = false;
            update_time(init_time);
        } 

        function beep() {
            var audio = new Audio('bell.mp3');
            audio.play();
        }
    </script>
</body>